<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="scripts/jquery.min.js"></script>
    <script type="text/javascript" src="scripts/bluebird.js"></script>
    <script type="text/javascript" src="scripts/cordova.oauth2.js"></script>
    <script type="text/javascript" src="scripts/graph-h5-sdk.js"></script>

    <script type="text/javascript" src="scripts/graph-contact.js"></script>
    <script type="text/javascript" src="scripts/graph-mail.js"></script>
    <script type="text/javascript" src="scripts/graph-meeting.js"></script>
    <script type="text/javascript" src="scripts/graph-calendar.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123430470-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-123430470-1');
    </script>

    <link type="text/css" rel="stylesheet" href="css/index.css" />
    <title>Oauth2 Cordova XDK</title>
</head>

<body>
    <svg>
        <defs>
            <symbol id="icon-cross" viewBox="0 0 32 32">
                <title>cross</title>
                <path d="M31.708 25.708c-0-0-0-0-0-0l-9.708-9.708 9.708-9.708c0-0 0-0 0-0 0.105-0.105 0.18-0.227 0.229-0.357 0.133-0.356 0.057-0.771-0.229-1.057l-4.586-4.586c-0.286-0.286-0.702-0.361-1.057-0.229-0.13 0.048-0.252 0.124-0.357 0.228 0 0-0 0-0 0l-9.708 9.708-9.708-9.708c-0-0-0-0-0-0-0.105-0.104-0.227-0.18-0.357-0.228-0.356-0.133-0.771-0.057-1.057 0.229l-4.586 4.586c-0.286 0.286-0.361 0.702-0.229 1.057 0.049 0.13 0.124 0.252 0.229 0.357 0 0 0 0 0 0l9.708 9.708-9.708 9.708c-0 0-0 0-0 0-0.104 0.105-0.18 0.227-0.229 0.357-0.133 0.355-0.057 0.771 0.229 1.057l4.586 4.586c0.286 0.286 0.702 0.361 1.057 0.229 0.13-0.049 0.252-0.124 0.357-0.229 0-0 0-0 0-0l9.708-9.708 9.708 9.708c0 0 0 0 0 0 0.105 0.105 0.227 0.18 0.357 0.229 0.356 0.133 0.771 0.057 1.057-0.229l4.586-4.586c0.286-0.286 0.362-0.702 0.229-1.057-0.049-0.13-0.124-0.252-0.229-0.357z"></path>
            </symbol>
            <symbol id="icon-chevron-left" viewBox="0 0 21 28">
                <title>chevron-left</title>
                <path d="M18.297 4.703l-8.297 8.297 8.297 8.297c0.391 0.391 0.391 1.016 0 1.406l-2.594 2.594c-0.391 0.391-1.016 0.391-1.406 0l-11.594-11.594c-0.391-0.391-0.391-1.016 0-1.406l11.594-11.594c0.391-0.391 1.016-0.391 1.406 0l2.594 2.594c0.391 0.391 0.391 1.016 0 1.406z"></path>
            </symbol>
        </defs>
    </svg>
    <div class="menu">
        <h3>H5 Graph SPA example</h3>
        <div class="login">
            <label></label>
            <a href="javascript:login(true)">login</a>
        </div>
        <p class="discirption">
            <!--H5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph
            SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph
            SPA SampleH5 Graph SPA SampleH5 Graph SPA SampleH5 Graph SPA Sample-->
        </p>

        <div class="category show">
            <div class="categoryHead">
                <p>Mail Scenario</p>
            </div>
            <div class="categoryInner">
                <div class="categoryContent">
                    <a href="#">
                        <p>Send Mail</p>
                    </a>
                    <a href="#">
                        <p>Show Mail List</p>
                    </a>
                    <a href="#">
                        <p>Show Mail Folder</p>
                    </a>
                </div>
            </div>
        </div>

        <div class="category">
            <div class="categoryHead">
                <p>Meeting Scenario</p>
            </div>
            <div class="categoryInner">
                <div class="categoryContent">
                    <a href="#">
                        <p>Create Meeting</p>
                    </a>
                    <a href="#">
                        <p>Get Meeting List</p>
                    </a>
                </div>
            </div>
        </div>

        <div class="category">
            <div class="categoryHead">
                <p>Calendar Scenario</p>
            </div>
            <div class="categoryInner">
                <div class="categoryContent">
                    <a href="#">
                        <p>Get Calendar List</p>
                    </a>
                    <a href="#">
                        <p>Get Calendar Group List</p>
                    </a>
                </div>
            </div>
        </div>

        <div class="category">
            <div class="categoryHead">
                <p>Contact Scenario</p>
            </div>
            <div class="categoryInner">
                <div class="categoryContent">
                    <a href="#">
                        <p>Contact List</p>
                    </a>
                </div>
            </div>
        </div>

    </div>
    <div id="sample" class="hidden">
        <div style="height:60px;background-color:#122892;display:table;width:100%;">
            <div style="display:table-row">
                <div style="display:table-cell;width:60px;">
                    <button style="background-color:transparent;border-color:transparent;width:60px;height:60px;" onclick="javascript: history.back()">
                        <svg style="width:32px;height:32px;fill:#ffffff;">
                            <use xlink:href="#icon-chevron-left"></use>
                        </svg>
                    </button>
                </div>
                <div style="display:table-cell;width:60px;text-align:left;vertical-align:middle">
                    <span style="color:#ffffff;">Back</span>
                </div>
                <div style="display:table-cell"></div>
            </div>
        </div>
        <h3 id="title">H5 Graph SPA Sample</h3>
        <!-- Mail -->
        <div id="Send Mail" class="sheet">
            <div class="top">
                <input type="button" class="input1 first last" value="Send Mail" onclick="SendMail()" />
            </div>
            <div class="box container form-control">
                <form>
                    <div style="padding:8px;">
                        <table class="table">
                            <tr>
                                <td style="width:80px;">To</td>
                                <td>
                                    <input name="address" type="text" />
                                </td>
                            </tr>
                            <tr>
                                <td style="width:80px;">Subject</td>
                                <td>
                                    <input name="subject" type="text" />
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div style="padding:8px;" class="content">
                        <editor contenteditable="true" name="content" style="min-height:200px;border:1px solid #cccccc;"></editor>
                    </div>
                    <!--
                        <section class="head">
                        <p>
                            <b>To</b>:
                            <input name="address" type="text" />
                        </p>
                        <p>
                            <b>Subject</b>:
                            <input name="subject" type="text" />
                        </p>
                    </section>
                    <section class="content">
                        <editor name="content" contenteditable="true">
                        </editor>
                    </section>
                    -->
                </form>
            </div>
        </div>

        <div id="Show Mail List" class="sheet">
            <div class="top">
                <div style="display:table;width:100%;">
                    <div style="display:table-row">
                        <div style="display:table-cell;position:relative;">
                            <input id="searchMailKeyword" style="width: 100%;text-align: left;padding-left: 1em;padding-right: 1em;" class="input first"
                                type="text" />
                            <span style="position:absolute;top:25px;right:16px;" onclick="searchMailKeyword.value = ''; Findamailwithspecifiedkeywords('')">
                                <svg style="width:16px;height:16px;">
                                    <use xlink:href="#icon-cross"></use>
                                </svg>
                            </span>
                        </div>
                        <div style="display:table-cell;width:100px;">
                            <input class="input last" style="width:100%" type="button" value="Search" onclick="Findamailwithspecifiedkeywords(searchMailKeyword.value)"
                            />
                        </div>
                    </div>
                </div>
            </div>
            <div class="box container">

            </div>
        </div>

        <div id="Show Single Mail" class="sheet">
            <div class="chooseFolder" style="display:none;" onclick="$('.chooseFolder').slideUp();">
                <div class="folderBox"></div>
            </div>
            <div class="top">
                <input class="input2 first" type="button" value="Mark Mail as read" onclick="MarkMailAsRead()" />
                <input class="input2 last" type="button" value="Copy Mail into Folder" onclick="$('.chooseFolder').slideDown(); params.mothed = 'Copy'; render.chooseFolder();"
                />
                <input class="input2 first" type="button" value="Move Mail into Folder" onclick="$('.chooseFolder').slideDown(); params.mothed = 'Move'; render.chooseFolder();"
                />
                <input class="input2 last" type="button" value="Delete Mail" onclick="DeleteMail()" />
            </div>
            <div class="box container form-control">
                <section class="head"></section>
                <section class="content">
                    <editor contenteditable="false"></editor>
                </section>
            </div>
        </div>

        <div id="Show Mail Folder" class="sheet">
            <div class="top">
                <input class="input1 first last" type="button" value="Create Folder Under Inbox" onclick="CreateFolderUnderInbox()" />
            </div>
            <div class="box container" style="flex-direction:row;">
            </div>
        </div>
        <!-- Meeting -->
        <div id="Create Meeting" class="sheet">
            <form>
                <div class="top">
                    <input class="input1 first last" type="button" value="Create Meeting" onclick="CreateMeeting()" />
                </div>
                <div class="box container form-control">
                    <div style="padding:8px;">
                        <table class="table head">
                            <tr>
                                <td style="width:100px;">Subject</td>
                                <td>
                                    <input type="text" name="subject" />
                                </td>
                            </tr>
                            <tr>
                                <td>Attendees</td>
                                <td>
                                    <input type="text" name="attendees" />
                                </td>
                            </tr>
                            <tr>
                                <td>Location</td>
                                <td>
                                    <input type="text" name="location" />
                                </td>
                            </tr>
                            <tr>
                                <td>StartTime</td>
                                <td>
                                    <input type="text" name="start" />
                                </td>
                            </tr>
                            <tr>
                                <td>EndTime</td>
                                <td>
                                    <input type="text" name="end" />
                                </td>
                            </tr>
                        </table>
                        <div class="content">
                            <editor contenteditable="true" name="content"></editor>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div id="Get Meeting List" class="sheet">
            <div class="top">
                <p name="name" style="margin-bottom:0;width: 100%;"></p>
                <input class="input3 first" type="button" value="In Meeting" onclick="GetInMeetingList()" />
                <input class="input3" type="button" value="Reminder Meeting" onclick="GetReminderMeetingList()" />
                <input class="input3 last" type="button" value="Out Meeting" onclick="GetOutMeetingList()" />
                <input name="update" class="input1 first last" type="button" value='Update calendar name as "example + {newDate}"' onclick="UpdateCalendar()"
                />
            </div>
            <div class="box container">
            </div>
        </div>

        <div id="Get One Meeting" class="sheet">
            <div class="top">
                <input class="input4 first" type="button" value="Accept" onclick="AcceptMeeting()" />
                <input class="input4" type="button" value="Tentatively" onclick="TentativelyAcceptMeeting()" />
                <input class="input4" type="button" value="Decline" onclick="DeclineMeeting()" />
                <input class="input4 last" type="button" value="Update" onclick="UpdateMeeting()" />
                <input class="input3 first" type="button" value="Dismiss Reminder" onclick="DismissMeeting()" />
                <input class="input3" type="button" value="Snooze Reminder" onclick="SnoozeMeeting()" />
                <input class="input3 last" type="button" value="Delete" onclick="DeleteMeeting()" />
            </div>
            <div class="box container form-control">
                <form>
                    <div style="padding:8px;">
                        <table class="table head">
                            <tr>
                                <td style="width:100px;">Organizer</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="organizer" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>Attendees</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="attendee" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>Subject</td>
                                <td>
                                    <input type="text" name="subject" />
                                </td>
                            </tr>
                            <tr>
                                <td>Location</td>
                                <td>
                                    <input type="text" name="location" />
                                </td>
                            </tr>
                            <tr>
                                <td>StartTime</td>
                                <td>
                                    <input type="datetime" name="start" />
                                </td>
                            </tr>
                            <tr>
                                <td>EndTime</td>
                                <td>
                                    <input type="datetime" name="end" />
                                </td>
                            </tr>
                        </table>
                        <div class="content">
                            <editor contenteditable="true"></editor>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <!-- Calendar -->
        <div id="Get Calendar List" class="sheet">
            <div class="top">
                <p name="name" style="margin-bottom:0;width: 100%;"></p>
                <input class="input1 first last" type="button" value="Create Calendar" onclick="CreateCalendar()" />
            </div>
            <div class="box container" style="flex-direction:row;">
            </div>
        </div>

        <div id="Get Calendar Group List" class="sheet">
            <div class="top">
                <input class="input1 first last" type="button" value="Create Calendar Group" onclick="CreateCalendarGroup()" />
            </div>
            <div class="box container" style="flex-direction:row;">
            </div>
        </div>
        <!-- Contact -->
        <div id="Contact List" class="sheet">
            <div class="box container">
            </div>
        </div>

        <div id="Show Single Contact" class="sheet">
            <div class="box container form-control">
                <form>
                    <div style="padding:8px;">
                        <table class="table head">
                            <tr>
                                <td style="width:100px;">givenName</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="givenName" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>surname</td>
                                <td>
                                    <input type="datetime" style="background: gainsboro;" name="surname" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>email</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="email" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>mobilePhone</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="mobilePhone" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>birthday</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="birthday" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>companyName</td>
                                <td>
                                    <input type="text" style="background: gainsboro;" name="companyName" readonly="readonly" />
                                </td>
                            </tr>
                            <tr>
                                <td>businessPhones</td>
                                <td>
                                    <input type="businessPhones" style="background: gainsboro;" name="businessPhones" readonly="readonly" />
                                </td>
                            </tr>
                        </table>
                    </div>
                </form>
            </div>
        </div>

        <div class="box footer">
            <pre id="response">
                <code class="javascript hljs">

                </code>
            </pre>
            <div id="request"></div>
            <div id="codeSituation"></div>
        </div>
    </div>

    <script type="text/javascript" src="scripts/index.js"></script>
    <script>
        var graph;
        function login(relogin) {
            var setting = {
                auth_url: 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize',
                // response_type: 'code',
                // response_type: 'token',
                token_url: 'https://login.microsoftonline.com/common/oauth2/v2.0/token',
                logout_url: '',         // recommended if available
                client_id: '41702e58-b8d2-468a-9a6b-4155af5538e8',          // required
                // client_secret: 'imOHgWz28cOiSkdFjTdXsyU',      // required if response_type = 'code'
                // redirect_uri: 'http://localhost:80',       // required - some dummy url
                // redirect_uri: 'msal86c196eb-2d99-48a8-a857-6b6c4e469746://auth',       // required - some dummy url
                other_params: {
                    scope: 'offline_access openid User.Read Mail.Read Mail.ReadWrite Mail.Send Calendars.Read Calendars.ReadWrite Contacts.ReadWrite'
                }        // optional params object for scope, state, display...
            }

            if (typeof cordova !== "undefined") {
                setting.response_type = "code";
                setting.redirect_uri = 'https://login.microsoftonline.com/common/oauth2/nativeclient';
            } else {
                setting.response_type = "token";
                setting.redirect_uri = 'http://localhost:80';
            }
            graph = new $.graph(setting, relogin)
        }
        login(false);
    </script>
</body>

</html>